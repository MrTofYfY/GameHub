<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MineDep Casino</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        * {
            font-family: 'Roboto', sans-serif;
        }
        .font-orbitron {
            font-family: 'Orbitron', sans-serif;
        }
        body {
            background: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%);
            min-height: 100vh;
        }
        .neon-border {
            box-shadow: 0 0 10px #00ff88, 0 0 20px #00ff8855, inset 0 0 10px #00ff8822;
        }
        .neon-red {
            box-shadow: 0 0 10px #ff4444, 0 0 20px #ff444455;
        }
        .tile {
            transition: all 0.3s ease;
            background: linear-gradient(145deg, #2a2a4a, #1a1a3a);
            box-shadow: 0 4px 15px rgba(0,0,0,0.4), inset 0 1px 0 rgba(255,255,255,0.1);
        }
        .tile:hover:not(.revealed) {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 8px 25px rgba(0,255,136,0.3), inset 0 1px 0 rgba(255,255,255,0.2);
        }
        .tile.revealed {
            transform: rotateY(180deg);
        }
        .tile-inner {
            transition: transform 0.5s;
            transform-style: preserve-3d;
        }
        .tile.revealed .tile-inner {
            transform: rotateY(180deg);
        }
        .tile-front, .tile-back {
            backface-visibility: hidden;
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 12px;
        }
        .tile-back {
            transform: rotateY(180deg);
        }
        .gem {
            background: linear-gradient(145deg, #00ff88, #00cc6a);
            box-shadow: 0 0 20px #00ff88aa;
        }
        .mine {
            background: linear-gradient(145deg, #ff4444, #cc2222);
            box-shadow: 0 0 20px #ff4444aa;
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        .pulse {
            animation: pulse 2s infinite;
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        .shake {
            animation: shake 0.5s ease-in-out;
        }
        @keyframes coinDrop {
            0% { transform: translateY(-20px); opacity: 0; }
            100% { transform: translateY(0); opacity: 1; }
        }
        .coin-drop {
            animation: coinDrop 0.5s ease-out;
        }
        .glass {
            background: rgba(255,255,255,0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
        }
        .multiplier-bar {
            background: linear-gradient(90deg, #00ff88 0%, #ffff00 50%, #ff4444 100%);
        }
        @keyframes explode {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.5); opacity: 0.8; }
            100% { transform: scale(2); opacity: 0; }
        }
        .explode {
            animation: explode 0.5s ease-out forwards;
        }
        .btn-glow {
            position: relative;
            overflow: hidden;
        }
        .btn-glow::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            transform: rotate(45deg);
            transition: all 0.5s;
        }
        .btn-glow:hover::before {
            left: 100%;
        }
        .popup-overlay {
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        .popup-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        .popup-content {
            transform: scale(0.8);
            transition: all 0.3s ease;
        }
        .popup-overlay.active .popup-content {
            transform: scale(1);
        }
        @keyframes scanline {
            0% { top: 0; }
            100% { top: 100%; }
        }
        .qr-scanline {
            animation: scanline 2s linear infinite;
        }
        .input-field {
            background: rgba(31, 41, 55, 0.5);
            border: 1px solid rgba(75, 85, 99, 1);
            border-radius: 0.75rem;
            padding: 0.75rem 1rem;
            width: 100%;
            color: white;
            transition: all 0.3s;
        }
        .input-field:focus {
            outline: none;
            border-color: #10b981;
        }
    </style>
</head>
<body class="text-white p-4 md:p-8">
    <!-- Auth Screen -->
    <div id="authScreen" class="min-h-screen flex items-center justify-center">
        <div class="glass rounded-3xl p-8 max-w-md w-full mx-4">
            <div class="text-center mb-8">
                <h1 class="font-orbitron text-3xl md:text-4xl font-black bg-gradient-to-r from-green-400 via-yellow-400 to-green-400 bg-clip-text text-transparent mb-2">
                    <i class="fas fa-gem text-green-400"></i> MineDep
                </h1>
                <p class="text-gray-400">Войдите или создайте аккаунт</p>
            </div>

            <div id="loginForm">
                <div class="mb-4">
                    <label class="text-gray-400 text-sm mb-2 block">Логин</label>
                    <input type="text" id="loginUsername" placeholder="Введите логин" class="input-field font-orbitron">
                </div>
                <div class="mb-6">
                    <label class="text-gray-400 text-sm mb-2 block">Пароль</label>
                    <input type="password" id="loginPassword" placeholder="Введите пароль" class="input-field font-orbitron">
                </div>
                <div id="authError" class="text-red-400 text-sm mb-4 hidden text-center"></div>
                <button id="loginBtn" class="w-full bg-gradient-to-r from-green-500 to-green-700 hover:from-green-400 hover:to-green-600 py-4 rounded-xl font-orbitron font-bold text-lg mb-3 transition-all btn-glow">
                    <i class="fas fa-sign-in-alt mr-2"></i>ВОЙТИ
                </button>
                <button id="showRegisterBtn" class="w-full bg-gray-700 hover:bg-gray-600 py-3 rounded-xl font-bold transition-all">
                    <i class="fas fa-user-plus mr-2"></i>Создать аккаунт
                </button>
            </div>

            <div id="registerForm" class="hidden">
                <div class="mb-4">
                    <label class="text-gray-400 text-sm mb-2 block">Логин</label>
                    <input type="text" id="regUsername" placeholder="Придумайте логин" class="input-field font-orbitron">
                </div>
                <div class="mb-4">
                    <label class="text-gray-400 text-sm mb-2 block">Пароль</label>
                    <input type="password" id="regPassword" placeholder="Придумайте пароль" class="input-field font-orbitron">
                </div>
                <div class="mb-6">
                    <label class="text-gray-400 text-sm mb-2 block">Повторите пароль</label>
                    <input type="password" id="regPasswordConfirm" placeholder="Повторите пароль" class="input-field font-orbitron">
                </div>
                <div id="regError" class="text-red-400 text-sm mb-4 hidden text-center"></div>
                <button id="registerBtn" class="w-full bg-gradient-to-r from-purple-500 to-purple-700 hover:from-purple-400 hover:to-purple-600 py-4 rounded-xl font-orbitron font-bold text-lg mb-3 transition-all btn-glow">
                    <i class="fas fa-user-plus mr-2"></i>ЗАРЕГИСТРИРОВАТЬСЯ
                </button>
                <button id="showLoginBtn" class="w-full bg-gray-700 hover:bg-gray-600 py-3 rounded-xl font-bold transition-all">
                    <i class="fas fa-arrow-left mr-2"></i>Назад к входу
                </button>
            </div>
        </div>
    </div>

    <!-- Main Game Screen -->
    <div id="gameScreen" class="max-w-6xl mx-auto hidden">
        <!-- Header -->
        <header class="text-center mb-8">
            <h1 class="font-orbitron text-4xl md:text-6xl font-black bg-gradient-to-r from-green-400 via-yellow-400 to-green-400 bg-clip-text text-transparent">
                <i class="fas fa-gem text-green-400"></i> MineDep Casino
            </h1>
        </header>

        <!-- Balance Section -->
        <div class="glass rounded-2xl p-4 mb-6 flex flex-wrap justify-between items-center gap-4">
            <div class="flex items-center gap-3">
                <div class="w-12 h-12 bg-gradient-to-br from-yellow-400 to-yellow-600 rounded-full flex items-center justify-center text-2xl shadow-lg">
                    <i class="fas fa-coins text-yellow-900"></i>
                </div>
                <div>
                    <p class="text-gray-400 text-sm">Баланс</p>
                    <p class="font-orbitron text-2xl font-bold text-yellow-400" id="balance">1000.00</p>
                </div>
            </div>
            <div class="flex items-center gap-3">
                <div class="text-right">
                    <p class="text-gray-400 text-sm">Игрок</p>
                    <p class="font-orbitron text-lg font-bold text-green-400" id="playerName">Player</p>
                </div>
                <button onclick="logout()" class="bg-gray-700 hover:bg-gray-600 p-3 rounded-xl transition-all" title="Выйти">
                    <i class="fas fa-sign-out-alt text-red-400"></i>
                </button>
            </div>
        </div>

        <div class="flex justify-end mb-4">
            <button onclick="openDepositPopup()" class="bg-gradient-to-r from-purple-600 to-purple-800 hover:from-purple-500 hover:to-purple-700 px-6 py-2 rounded-xl font-bold transition-all btn-glow">
                <i class="fas fa-plus-circle mr-2"></i>Пополнить
            </button>
        </div>

        <div class="grid lg:grid-cols-3 gap-6">
            <!-- Game Controls -->
            <div class="glass rounded-2xl p-6 order-2 lg:order-1">
                <h2 class="font-orbitron text-xl mb-6 text-center"><i class="fas fa-cog mr-2"></i>Настройки</h2>
                
                <!-- Bet Amount -->
                <div class="mb-6">
                    <label class="text-gray-400 text-sm mb-2 block">Ставка</label>
                    <input type="text" inputmode="decimal" id="betAmount" value="10" 
                        oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1')"
                        class="w-full bg-gray-800/50 border border-gray-700 rounded-xl px-4 py-3 font-orbitron text-lg focus:border-green-500 focus:outline-none mb-2">
                    <div class="flex gap-2">
                        <button onclick="setBet(0.5)" class="flex-1 bg-gray-700 hover:bg-gray-600 px-3 py-2 rounded-lg text-sm transition-all">½</button>
                        <button onclick="setBet(2)" class="flex-1 bg-gray-700 hover:bg-gray-600 px-3 py-2 rounded-lg text-sm transition-all">2×</button>
                    </div>
                </div>

                <!-- Mines Count -->
                <div class="mb-6">
                    <label class="text-gray-400 text-sm mb-2 block">Количество мин: <span id="minesDisplay" class="text-red-400 font-bold">3</span></label>
                    <input type="range" id="minesCount" min="1" max="24" value="3" 
                        class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-red-500"
                        oninput="updateMinesDisplay()">
                    <div class="flex justify-between text-xs text-gray-500 mt-1">
                        <span>1</span>
                        <span>24</span>
                    </div>
                </div>

                <!-- Potential Win -->
                <div class="bg-gray-800/50 rounded-xl p-4 mb-6">
                    <div class="flex justify-between mb-2">
                        <span class="text-gray-400">Множитель</span>
                        <span class="font-orbitron text-green-400" id="currentMultiplier">1.00×</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-400">Потенциальный выигрыш</span>
                        <span class="font-orbitron text-yellow-400" id="potentialWin">0.00</span>
                    </div>
                </div>

                <!-- Action Buttons -->
                <button id="playBtn" onclick="startGame()" 
                    class="w-full bg-gradient-to-r from-green-500 to-green-700 hover:from-green-400 hover:to-green-600 py-4 rounded-xl font-orbitron font-bold text-lg mb-3 transition-all btn-glow pulse">
                    <i class="fas fa-play mr-2"></i>ИГРАТЬ
                </button>
                <button id="cashoutBtn" onclick="cashout()" disabled
                    class="w-full bg-gradient-to-r from-yellow-500 to-orange-500 hover:from-yellow-400 hover:to-orange-400 py-4 rounded-xl font-orbitron font-bold text-lg transition-all btn-glow disabled:opacity-50 disabled:cursor-not-allowed">
                    <i class="fas fa-hand-holding-dollar mr-2"></i>ЗАБРАТЬ
                </button>
            </div>

            <!-- Game Grid -->
            <div class="lg:col-span-2 order-1 lg:order-2">
                <div class="glass rounded-2xl p-6">
                    <div class="grid grid-cols-5 gap-3" id="gameGrid">
                        <!-- Tiles will be generated here -->
                    </div>
                </div>

                <!-- Game Info -->
                <div class="mt-4 flex flex-wrap justify-center gap-4 text-sm">
                    <div class="flex items-center gap-2 bg-gray-800/50 px-4 py-2 rounded-lg">
                        <i class="fas fa-gem text-2xl text-green-400"></i>
                        <span>Гемов найдено: <span id="gemsFound" class="text-green-400 font-bold">0</span></span>
                    </div>
                    <div class="flex items-center gap-2 bg-gray-800/50 px-4 py-2 rounded-lg">
                        <i class="fas fa-bomb text-2xl text-red-400"></i>
                        <span>Мин на поле: <span id="minesOnField" class="text-red-400 font-bold">3</span></span>
                    </div>
                </div>

                <!-- Sound Toggle -->
                <div class="mt-4 flex justify-center">
                    <button onclick="toggleSound()" id="soundBtn" class="bg-gray-800/50 hover:bg-gray-700/50 px-4 py-2 rounded-lg text-sm transition-all">
                        <i class="fas fa-volume-high mr-2" id="soundIcon"></i>
                        <span id="soundText">Звук: ВКЛ</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- History -->
        <div class="glass rounded-2xl p-6 mt-6">
            <h2 class="font-orbitron text-xl mb-4"><i class="fas fa-chart-line mr-2"></i>История игр</h2>
            <div id="history" class="flex gap-2 overflow-x-auto pb-2">
                <div class="text-gray-500 text-sm">История пуста</div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="text-center mt-8 text-gray-500 text-sm">
            <p class="mt-1">MineDep Casino © 2023-2026 | 18+</p>
        </footer>
    </div>

    <!-- Game Popup -->
    <div id="gamePopup" class="fixed inset-0 bg-black/80 flex items-center justify-center z-50 popup-overlay">
        <div class="glass rounded-3xl p-8 text-center max-w-md mx-4 popup-content">
            <div class="text-6xl mb-4" id="popupEmoji"><i class="fas fa-coins text-yellow-400"></i></div>
            <h2 class="font-orbitron text-3xl font-black mb-2" id="popupTitle">ВЫИГРЫШ!</h2>
            <p class="text-4xl font-orbitron text-yellow-400 mb-6" id="popupAmount">+100.00</p>
            <button onclick="closeGamePopup()" class="bg-gradient-to-r from-green-500 to-green-700 hover:from-green-400 hover:to-green-600 px-8 py-3 rounded-xl font-bold transition-all">
                <i class="fas fa-check mr-2"></i>Продолжить
            </button>
        </div>
    </div>

    <!-- Deposit Popup -->
    <div id="depositPopup" class="fixed inset-0 bg-black/80 flex items-center justify-center z-50 popup-overlay">
        <div class="glass rounded-3xl p-8 text-center max-w-md mx-4 popup-content">
            <div class="text-5xl mb-4"><i class="fas fa-wallet text-purple-400"></i></div>
            <h2 class="font-orbitron text-2xl font-black mb-6 text-purple-400">Пополнение баланса</h2>
            
            <div class="mb-6">
                <label class="text-gray-400 text-sm mb-2 block text-left">Сумма пополнения</label>
                <input type="text" inputmode="decimal" id="depositAmount" value="500" 
                    oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1')"
                    class="w-full bg-gray-800/50 border border-gray-700 rounded-xl px-4 py-3 font-orbitron text-xl text-center focus:border-purple-500 focus:outline-none">
            </div>
            
            <div class="flex gap-2 mb-6">
                <button onclick="setDepositAmount(100)" class="flex-1 bg-gray-700 hover:bg-gray-600 py-2 rounded-lg text-sm transition-all">100</button>
                <button onclick="setDepositAmount(500)" class="flex-1 bg-gray-700 hover:bg-gray-600 py-2 rounded-lg text-sm transition-all">500</button>
                <button onclick="setDepositAmount(1000)" class="flex-1 bg-gray-700 hover:bg-gray-600 py-2 rounded-lg text-sm transition-all">1000</button>
                <button onclick="setDepositAmount(5000)" class="flex-1 bg-gray-700 hover:bg-gray-600 py-2 rounded-lg text-sm transition-all">5000</button>
            </div>
            
            <button onclick="processPayment()" class="w-full bg-gradient-to-r from-purple-500 to-purple-700 hover:from-purple-400 hover:to-purple-600 py-4 rounded-xl font-orbitron font-bold text-lg mb-3 transition-all">
                <i class="fas fa-credit-card mr-2"></i>Оплатить
            </button>
            <button onclick="closeDepositPopup()" class="w-full bg-gray-700 hover:bg-gray-600 py-3 rounded-xl font-bold transition-all">
                <i class="fas fa-times mr-2"></i>Отмена
            </button>
        </div>
    </div>

    <!-- QR Code Popup -->
    <div id="qrPopup" class="fixed inset-0 bg-black/80 flex items-center justify-center z-50 popup-overlay">
        <div class="glass rounded-3xl p-8 text-center max-w-md mx-4 popup-content">
            <div class="text-5xl mb-4"><i class="fas fa-qrcode text-white"></i></div>
            <h2 class="font-orbitron text-xl font-black mb-2 text-white">Отсканируйте для оплаты</h2>
            <p class="text-gray-400 text-sm mb-6">Сумма: <span id="qrAmount" class="text-yellow-400 font-bold">500</span> ₽</p>
            
            <!-- Fake QR Code -->
            <div class="relative inline-block bg-white p-4 rounded-2xl mb-6">
                <svg width="200" height="200" viewBox="0 0 200 200" class="block">
                    <!-- QR Pattern -->
                    <rect fill="#000" x="10" y="10" width="40" height="40"/>
                    <rect fill="#fff" x="15" y="15" width="30" height="30"/>
                    <rect fill="#000" x="20" y="20" width="20" h            transform: rotateY(180deg);
        }
        .tile-inner {
            transition: transform 0.5s;
            transform-style: preserve-3d;
        }
        .tile.revealed .tile-inner {
            transform: rotateY(180deg);
        }
        .tile-front, .tile-back {
            backface-visibility: hidden;
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 12px;
        }
        .tile-back {
            transform: rotateY(180deg);
        }
        .gem {
            background: linear-gradient(145deg, #00ff88, #00cc6a);
            box-shadow: 0 0 20px #00ff88aa;
        }
        .mine {
            background: linear-gradient(145deg, #ff4444, #cc2222);
            box-shadow: 0 0 20px #ff4444aa;
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        .pulse {
            animation: pulse 2s infinite;
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        .shake {
            animation: shake 0.5s ease-in-out;
        }
        @keyframes coinDrop {
            0% { transform: translateY(-20px); opacity: 0; }
            100% { transform: translateY(0); opacity: 1; }
        }
        .coin-drop {
            animation: coinDrop 0.5s ease-out;
        }
        .glass {
            background: rgba(255,255,255,0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
        }
        .multiplier-bar {
            background: linear-gradient(90deg, #00ff88 0%, #ffff00 50%, #ff4444 100%);
        }
        @keyframes explode {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.5); opacity: 0.8; }
            100% { transform: scale(2); opacity: 0; }
        }
        .explode {
            animation: explode 0.5s ease-out forwards;
        }
        .btn-glow {
            position: relative;
            overflow: hidden;
        }
        .btn-glow::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            transform: rotate(45deg);
            transition: all 0.5s;
        }
        .btn-glow:hover::before {
            left: 100%;
        }
        .popup-overlay {
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        .popup-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        .popup-content {
            transform: scale(0.8);
            transition: all 0.3s ease;
        }
        .popup-overlay.active .popup-content {
            transform: scale(1);
        }
        @keyframes scanline {
            0% { top: 0; }
            100% { top: 100%; }
        }
        .qr-scanline {
            animation: scanline 2s linear infinite;
        }
        .input-field {
            background: rgba(31, 41, 55, 0.5);
            border: 1px solid rgba(75, 85, 99, 1);
            border-radius: 0.75rem;
            padding: 0.75rem 1rem;
            width: 100%;
            color: white;
            transition: all 0.3s;
        }
        .input-field:focus {
            outline: none;
            border-color: #10b981;
        }
    </style>
</head>
<body class="text-white p-4 md:p-8">
    <!-- Auth Screen -->
    <div id="authScreen" class="min-h-screen flex items-center justify-center">
        <div class="glass rounded-3xl p-8 max-w-md w-full mx-4">
            <div class="text-center mb-8">
                <h1 class="font-orbitron text-3xl md:text-4xl font-black bg-gradient-to-r from-green-400 via-yellow-400 to-green-400 bg-clip-text text-transparent mb-2">
                    <i class="fas fa-gem text-green-400"></i> MineDep
                </h1>
                <p class="text-gray-400">Войдите или создайте аккаунт</p>
            </div>

            <div id="loginForm">
                <div class="mb-4">
                    <label class="text-gray-400 text-sm mb-2 block">Логин</label>
                    <input type="text" id="loginUsername" placeholder="Введите логин" class="input-field font-orbitron">
                </div>
                <div class="mb-6">
                    <label class="text-gray-400 text-sm mb-2 block">Пароль</label>
                    <input type="password" id="loginPassword" placeholder="Введите пароль" class="input-field font-orbitron">
                </div>
                <div id="authError" class="text-red-400 text-sm mb-4 hidden text-center"></div>
                <button onclick="login()" class="w-full bg-gradient-to-r from-green-500 to-green-700 hover:from-green-400 hover:to-green-600 py-4 rounded-xl font-orbitron font-bold text-lg mb-3 transition-all btn-glow">
                    <i class="fas fa-sign-in-alt mr-2"></i>ВОЙТИ
                </button>
                <button onclick="showRegister()" class="w-full bg-gray-700 hover:bg-gray-600 py-3 rounded-xl font-bold transition-all">
                    <i class="fas fa-user-plus mr-2"></i>Создать аккаунт
                </button>
            </div>

            <div id="registerForm" class="hidden">
                <div class="mb-4">
                    <label class="text-gray-400 text-sm mb-2 block">Логин</label>
                    <input type="text" id="regUsername" placeholder="Придумайте логин" class="input-field font-orbitron">
                </div>
                <div class="mb-4">
                    <label class="text-gray-400 text-sm mb-2 block">Пароль</label>
                    <input type="password" id="regPassword" placeholder="Придумайте пароль" class="input-field font-orbitron">
                </div>
                <div class="mb-6">
                    <label class="text-gray-400 text-sm mb-2 block">Повторите пароль</label>
                    <input type="password" id="regPasswordConfirm" placeholder="Повторите пароль" class="input-field font-orbitron">
                </div>
                <div id="regError" class="text-red-400 text-sm mb-4 hidden text-center"></div>
                <button onclick="register()" class="w-full bg-gradient-to-r from-purple-500 to-purple-700 hover:from-purple-400 hover:to-purple-600 py-4 rounded-xl font-orbitron font-bold text-lg mb-3 transition-all btn-glow">
                    <i class="fas fa-user-plus mr-2"></i>ЗАРЕГИСТРИРОВАТЬСЯ
                </button>
                <button onclick="showLogin()" class="w-full bg-gray-700 hover:bg-gray-600 py-3 rounded-xl font-bold transition-all">
                    <i class="fas fa-arrow-left mr-2"></i>Назад к входу
                </button>
            </div>
        </div>
    </div>

    <!-- Main Game Screen -->
    <div id="gameScreen" class="max-w-6xl mx-auto hidden">
        <!-- Header -->
        <header class="text-center mb-8">
            <h1 class="font-orbitron text-4xl md:text-6xl font-black bg-gradient-to-r from-green-400 via-yellow-400 to-green-400 bg-clip-text text-transparent">
                <i class="fas fa-gem text-green-400"></i> MineDep Casino
            </h1>
        </header>

        <!-- Balance Section -->
        <div class="glass rounded-2xl p-4 mb-6 flex flex-wrap justify-between items-center gap-4">
            <div class="flex items-center gap-3">
                <div class="w-12 h-12 bg-gradient-to-br from-yellow-400 to-yellow-600 rounded-full flex items-center justify-center text-2xl shadow-lg">
                    <i class="fas fa-coins text-yellow-900"></i>
                </div>
                <div>
                    <p class="text-gray-400 text-sm">Баланс</p>
                    <p class="font-orbitron text-2xl font-bold text-yellow-400" id="balance">1000.00</p>
                </div>
            </div>
            <div class="flex items-center gap-3">
                <div class="text-right">
                    <p class="text-gray-400 text-sm">Игрок</p>
                    <p class="font-orbitron text-lg font-bold text-green-400" id="playerName">Player</p>
                </div>
                <button onclick="logout()" class="bg-gray-700 hover:bg-gray-600 p-3 rounded-xl transition-all" title="Выйти">
                    <i class="fas fa-sign-out-alt text-red-400"></i>
                </button>
            </div>
        </div>

        <div class="flex justify-end mb-4">
            <button onclick="openDepositPopup()" class="bg-gradient-to-r from-purple-600 to-purple-800 hover:from-purple-500 hover:to-purple-700 px-6 py-2 rounded-xl font-bold transition-all btn-glow">
                <i class="fas fa-plus-circle mr-2"></i>Пополнить
            </button>
        </div>

        <div class="grid lg:grid-cols-3 gap-6">
            <!-- Game Controls -->
            <div class="glass rounded-2xl p-6 order-2 lg:order-1">
                <h2 class="font-orbitron text-xl mb-6 text-center"><i class="fas fa-cog mr-2"></i>Настройки</h2>
                
                <!-- Bet Amount -->
                <div class="mb-6">
                    <label class="text-gray-400 text-sm mb-2 block">Ставка</label>
                    <input type="text" inputmode="decimal" id="betAmount" value="10" 
                        oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1')"
                        class="w-full bg-gray-800/50 border border-gray-700 rounded-xl px-4 py-3 font-orbitron text-lg focus:border-green-500 focus:outline-none mb-2">
                    <div class="flex gap-2">
                        <button onclick="setBet(0.5)" class="flex-1 bg-gray-700 hover:bg-gray-600 px-3 py-2 rounded-lg text-sm transition-all">½</button>
                        <button onclick="setBet(2)" class="flex-1 bg-gray-700 hover:bg-gray-600 px-3 py-2 rounded-lg text-sm transition-all">2×</button>
                    </div>
                </div>

                <!-- Mines Count -->
                <div class="mb-6">
                    <label class="text-gray-400 text-sm mb-2 block">Количество мин: <span id="minesDisplay" class="text-red-400 font-bold">3</span></label>
                    <input type="range" id="minesCount" min="1" max="24" value="3" 
                        class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-red-500"
                        oninput="updateMinesDisplay()">
                    <div class="flex justify-between text-xs text-gray-500 mt-1">
                        <span>1</span>
                        <span>24</span>
                    </div>
                </div>

                <!-- Potential Win -->
                <div class="bg-gray-800/50 rounded-xl p-4 mb-6">
                    <div class="flex justify-between mb-2">
                        <span class="text-gray-400">Множитель</span>
                        <span class="font-orbitron text-green-400" id="currentMultiplier">1.00×</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-400">Потенциальный выигрыш</span>
                        <span class="font-orbitron text-yellow-400" id="potentialWin">0.00</span>
                    </div>
                </div>

                <!-- Action Buttons -->
                <button id="playBtn" onclick="startGame()" 
                    class="w-full bg-gradient-to-r from-green-500 to-green-700 hover:from-green-400 hover:to-green-600 py-4 rounded-xl font-orbitron font-bold text-lg mb-3 transition-all btn-glow pulse">
                    <i class="fas fa-play mr-2"></i>ИГРАТЬ
                </button>
                <button id="cashoutBtn" onclick="cashout()" disabled
                    class="w-full bg-gradient-to-r from-yellow-500 to-orange-500 hover:from-yellow-400 hover:to-orange-400 py-4 rounded-xl font-orbitron font-bold text-lg transition-all btn-glow disabled:opacity-50 disabled:cursor-not-allowed">
                    <i class="fas fa-hand-holding-dollar mr-2"></i>ЗАБРАТЬ
                </button>
            </div>

            <!-- Game Grid -->
            <div class="lg:col-span-2 order-1 lg:order-2">
                <div class="glass rounded-2xl p-6">
                    <div class="grid grid-cols-5 gap-3" id="gameGrid">
                        <!-- Tiles will be generated here -->
                    </div>
                </div>

                <!-- Game Info -->
                <div class="mt-4 flex flex-wrap justify-center gap-4 text-sm">
                    <div class="flex items-center gap-2 bg-gray-800/50 px-4 py-2 rounded-lg">
                        <i class="fas fa-gem text-2xl text-green-400"></i>
                        <span>Гемов найдено: <span id="gemsFound" class="text-green-400 font-bold">0</span></span>
                    </div>
                    <div class="flex items-center gap-2 bg-gray-800/50 px-4 py-2 rounded-lg">
                        <i class="fas fa-bomb text-2xl text-red-400"></i>
                        <span>Мин на поле: <span id="minesOnField" class="text-red-400 font-bold">3</span></span>
                    </div>
                </div>

                <!-- Sound Toggle -->
                <div class="mt-4 flex justify-center">
                    <button onclick="toggleSound()" id="soundBtn" class="bg-gray-800/50 hover:bg-gray-700/50 px-4 py-2 rounded-lg text-sm transition-all">
                        <i class="fas fa-volume-high mr-2" id="soundIcon"></i>
                        <span id="soundText">Звук: ВКЛ</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- History -->
        <div class="glass rounded-2xl p-6 mt-6">
            <h2 class="font-orbitron text-xl mb-4"><i class="fas fa-chart-line mr-2"></i>История игр</h2>
            <div id="history" class="flex gap-2 overflow-x-auto pb-2">
                <div class="text-gray-500 text-sm">История пуста</div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="text-center mt-8 text-gray-500 text-sm">
            <p class="mt-1">MineDep Casino © 2023-2026 | 18+</p>
        </footer>
    </div>

    <!-- Game Popup -->
    <div id="gamePopup" class="fixed inset-0 bg-black/80 flex items-center justify-center z-50 popup-overlay">
        <div class="glass rounded-3xl p-8 text-center max-w-md mx-4 popup-content">
            <div class="text-6xl mb-4" id="popupEmoji"><i class="fas fa-coins text-yellow-400"></i></div>
            <h2 class="font-orbitron text-3xl font-black mb-2" id="popupTitle">ВЫИГРЫШ!</h2>
            <p class="text-4xl font-orbitron text-yellow-400 mb-6" id="popupAmount">+100.00</p>
            <button onclick="closeGamePopup()" class="bg-gradient-to-r from-green-500 to-green-700 hover:from-green-400 hover:to-green-600 px-8 py-3 rounded-xl font-bold transition-all">
                <i class="fas fa-check mr-2"></i>Продолжить
            </button>
        </div>
    </div>

    <!-- Deposit Popup -->
    <div id="depositPopup" class="fixed inset-0 bg-black/80 flex items-center justify-center z-50 popup-overlay">
        <div class="glass rounded-3xl p-8 text-center max-w-md mx-4 popup-content">
            <div class="text-5xl mb-4"><i class="fas fa-wallet text-purple-400"></i></div>
            <h2 class="font-orbitron text-2xl font-black mb-6 text-purple-400">Пополнение баланса</h2>
            
            <div class="mb-6">
                <label class="text-gray-400 text-sm mb-2 block text-left">Сумма пополнения</label>
                <input type="text" inputmode="decimal" id="depositAmount" value="500" 
                    oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1')"
                    class="w-full bg-gray-800/50 border border-gray-700 rounded-xl px-4 py-3 font-orbitron text-xl text-center focus:border-purple-500 focus:outline-none">
            </div>
            
            <div class="flex gap-2 mb-6">
                <button onclick="setDepositAmount(100)" class="flex-1 bg-gray-700 hover:bg-gray-600 py-2 rounded-lg text-sm transition-all">100</button>
                <button onclick="setDepositAmount(500)" class="flex-1 bg-gray-700 hover:bg-gray-600 py-2 rounded-lg text-sm transition-all">500</button>
                <button onclick="setDepositAmount(1000)" class="flex-1 bg-gray-700 hover:bg-gray-600 py-2 rounded-lg text-sm transition-all">1000</button>
                <button onclick="setDepositAmount(5000)" class="flex-1 bg-gray-700 hover:bg-gray-600 py-2 rounded-lg text-sm transition-all">5000</button>
            </div>
            
            <button onclick="processPayment()" class="w-full bg-gradient-to-r from-purple-500 to-purple-700 hover:from-purple-400 hover:to-purple-600 py-4 rounded-xl font-orbitron font-bold text-lg mb-3 transition-all">
                <i class="fas fa-credit-card mr-2"></i>Оплатить
            </button>
            <button onclick="closeDepositPopup()" class="w-full bg-gray-700 hover:bg-gray-600 py-3 rounded-xl font-bold transition-all">
                <i class="fas fa-times mr-2"></i>Отмена
            </button>
        </div>
    </div>

    <!-- QR Code Popup -->
    <div id="qrPopup" class="fixed inset-0 bg-black/80 flex items-center justify-center z-50 popup-overlay">
        <div class="glass rounded-3xl p-8 text-center max-w-md mx-4 popup-content">
            <div class="text-5xl mb-4"><i class="fas fa-qrcode text-white"></i></div>
            <h2 class="font-orbitron text-xl font-black mb-2 text-white">Отсканируйте для оплаты</h2>
            <p class="text-gray-400 text-sm mb-6">Сумма: <span id="qrAmount" class="text-yellow-400 font-bold">500</span> ₽</p>
            
            <!-- Fake QR Code -->
            <div class="relative inline-block bg-white p-4 rounded-2xl mb-6">
                <svg width="200" height="200" viewBox="0 0 200 200" class="block">
                    <!-- QR Pattern -->
                    <rect fill="#000" x="10" y="10" width="40" height="40"/>
                    <rect fill="#fff" x="15" y="15" width="30" height="30"/>
                    <rect fill="#000" x="20" y="hover:bg-gray-600 p-3 rounded-xl transition-all" title="Выйти">
                    <i class="fas fa-sign-out-alt text-red-400"></i>
                </button>
            </div>
        </div>

        <div class="flex justify-end mb-4">
            <button onclick="openDepositPopup()" class="bg-gradient-to-r from-purple-600 to-purple-800 hover:from-purple-500 hover:to-purple-700 px-6 py-2 rounded-xl font-bold transition-all btn-glow">
                <i class="fas fa-plus-circle mr-2"></i>Пополнить
            </button>
        </div>

        <div class="grid lg:grid-cols-3 gap-6">
            <!-- Game Controls -->
            <div class="glass rounded-2xl p-6 order-2 lg:order-1">
                <h2 class="font-orbitron text-xl mb-6 text-center"><i class="fas fa-cog mr-2"></i>Настройки</h2>
                
                <!-- Bet Amount -->
                <div class="mb-6">
                    <label class="text-gray-400 text-sm mb-2 block">Ставка</label>
                    <input type="text" inputmode="decimal" id="betAmount" value="10" 
                        oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1')"
                        class="w-full bg-gray-800/50 border border-gray-700 rounded-xl px-4 py-3 font-orbitron text-lg focus:border-green-500 focus:outline-none mb-2">
                    <div class="flex gap-2">
                        <button onclick="setBet(0.5)" class="flex-1 bg-gray-700 hover:bg-gray-600 px-3 py-2 rounded-lg text-sm transition-all">½</button>
                        <button onclick="setBet(2)" class="flex-1 bg-gray-700 hover:bg-gray-600 px-3 py-2 rounded-lg text-sm transition-all">2×</button>
                    </div>
                </div>

                <!-- Mines Count -->
                <div class="mb-6">
                    <label class="text-gray-400 text-sm mb-2 block">Количество мин: <span id="minesDisplay" class="text-red-400 font-bold">3</span></label>
                    <input type="range" id="minesCount" min="1" max="24" value="3" 
                        class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-red-500"
                        oninput="updateMinesDisplay()">
                    <div class="flex justify-between text-xs text-gray-500 mt-1">
                        <span>1</span>
                        <span>24</span>
                    </div>
                </div>

                <!-- Potential Win -->
                <div class="bg-gray-800/50 rounded-xl p-4 mb-6">
                    <div class="flex justify-between mb-2">
                        <span class="text-gray-400">Множитель</span>
                        <span class="font-orbitron text-green-400" id="currentMultiplier">1.00×</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-400">Потенциальный выигрыш</span>
                        <span class="font-orbitron text-yellow-400" id="potentialWin">0.00</span>
                    </div>
                </div>

                <!-- Action Buttons -->
                <button id="playBtn" onclick="startGame()" 
                    class="w-full bg-gradient-to-r from-green-500 to-green-700 hover:from-green-400 hover:to-green-600 py-4 rounded-xl font-orbitron font-bold text-lg mb-3 transition-all btn-glow pulse">
                    <i class="fas fa-play mr-2"></i>ИГРАТЬ
                </button>
                <button id="cashoutBtn" onclick="cashout()" disabled
                    class="w-full bg-gradient-to-r from-yellow-500 to-orange-500 hover:from-yellow-400 hover:to-orange-400 py-4 rounded-xl font-orbitron font-bold text-lg transition-all btn-glow disabled:opacity-50 disabled:cursor-not-allowed">
                    <i class="fas fa-hand-holding-dollar mr-2"></i>ЗАБРАТЬ
                </button>
            </div>

            <!-- Game Grid -->
            <div class="lg:col-span-2 order-1 lg:order-2">
                <div class="glass rounded-2xl p-6">
                    <div class="grid grid-cols-5 gap-3" id="gameGrid">
                        <!-- Tiles will be generated here -->
                    </div>
                </div>

                <!-- Game Info -->
                <div class="mt-4 flex flex-wrap justify-center gap-4 text-sm">
                    <div class="flex items-center gap-2 bg-gray-800/50 px-4 py-2 rounded-lg">
                        <i class="fas fa-gem text-2xl text-green-400"></i>
                        <span>Гемов найдено: <span id="gemsFound" class="text-green-400 font-bold">0</span></span>
                    </div>
                    <div class="flex items-center gap-2 bg-gray-800/50 px-4 py-2 rounded-lg">
                        <i class="fas fa-bomb text-2xl text-red-400"></i>
                        <span>Мин на поле: <span id="minesOnField" class="text-red-400 font-bold">3</span></span>
                    </div>
                </div>

                <!-- Sound Toggle -->
                <div class="mt-4 flex justify-center">
                    <button onclick="toggleSound()" id="soundBtn" class="bg-gray-800/50 hover:bg-gray-700/50 px-4 py-2 rounded-lg text-sm transition-all">
                        <i class="fas fa-volume-high mr-2" id="soundIcon"></i>
                        <span id="soundText">Звук: ВКЛ</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- History -->
        <div class="glass rounded-2xl p-6 mt-6">
            <h2 class="font-orbitron text-xl mb-4"><i class="fas fa-chart-line mr-2"></i>История игр</h2>
            <div id="history" class="flex gap-2 overflow-x-auto pb-2">
                <div class="text-gray-500 text-sm">История пуста</div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="text-center mt-8 text-gray-500 text-sm">
            <p class="mt-1">MineDep Casino © 2023-2026 | 18+</p>
        </footer>
    </div>

    <!-- Game Popup -->
    <div id="gamePopup" class="fixed inset-0 bg-black/80 flex items-center justify-center z-50 popup-overlay">
        <div class="glass rounded-3xl p-8 text-center max-w-md mx-4 popup-content">
            <div class="text-6xl mb-4" id="popupEmoji"><i class="fas fa-coins text-yellow-400"></i></div>
            <h2 class="font-orbitron text-3xl font-black mb-2" id="popupTitle">ВЫИГРЫШ!</h2>
            <p class="text-4xl font-orbitron text-yellow-400 mb-6" id="popupAmount">+100.00</p>
            <button onclick="closeGamePopup()" class="bg-gradient-to-r from-green-500 to-green-700 hover:from-green-400 hover:to-green-600 px-8 py-3 rounded-xl font-bold transition-all">
                <i class="fas fa-check mr-2"></i>Продолжить
            </button>
        </div>
    </div>

    <!-- Deposit Popup -->
    <div id="depositPopup" class="fixed inset-0 bg-black/80 flex items-center justify-center z-50 popup-overlay">
        <div class="glass rounded-3xl p-8 text-center max-w-md mx-4 popup-content">
            <div class="text-5xl mb-4"><i class="fas fa-wallet text-purple-400"></i></div>
            <h2 class="font-orbitron text-2xl font-black mb-6 text-purple-400">Пополнение баланса</h2>
            
            <div class="mb-6">
                <label class="text-gray-400 text-sm mb-2 block text-left">Сумма пополнения</label>
                <input type="text" inputmode="decimal" id="depositAmount" value="500" 
                    oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1')"
                    class="w-full bg-gray-800/50 border border-gray-700 rounded-xl px-4 py-3 font-orbitron text-xl text-center focus:border-purple-500 focus:outline-none">
            </div>
            
            <div class="flex gap-2 mb-6">
                <button onclick="setDepositAmount(100)" class="flex-1 bg-gray-700 hover:bg-gray-600 py-2 rounded-lg text-sm transition-all">100</button>
                <button onclick="setDepositAmount(500)" class="flex-1 bg-gray-700 hover:bg-gray-600 py-2 rounded-lg text-sm transition-all">500</button>
                <button onclick="setDepositAmount(1000)" class="flex-1 bg-gray-700 hover:bg-gray-600 py-2 rounded-lg text-sm transition-all">1000</button>
                <button onclick="setDepositAmount(5000)" class="flex-1 bg-gray-700 hover:bg-gray-600 py-2 rounded-lg text-sm transition-all">5000</button>
            </div>
            
            <button onclick="processPayment()" class="w-full bg-gradient-to-r from-purple-500 to-purple-700 hover:from-purple-400 hover:to-purple-600 py-4 rounded-xl font-orbitron font-bold text-lg mb-3 transition-all">
                <i class="fas fa-credit-card mr-2"></i>Оплатить
            </button>
            <button onclick="closeDepositPopup()" class="w-full bg-gray-700 hover:bg-gray-600 py-3 rounded-xl font-bold transition-all">
                <i class="fas fa-times mr-2"></i>Отмена
            </button>
        </div>
    </div>

    <!-- QR Code Popup -->
    <div id="qrPopup" class="fixed inset-0 bg-black/80 flex items-center justify-center z-50 popup-overlay">
        <div class="glass rounded-3xl p-8 text-center max-w-md mx-4 popup-content">
            <div class="text-5xl mb-4"><i class="fas fa-qrcode text-white"></i></div>
            <h2 class="font-orbitron text-xl font-black mb-2 text-white">Отсканируйте для оплаты</h2>
            <p class="text-gray-400 text-sm mb-6">Сумма: <span id="qrAmount" class="text-yellow-400 font-bold">500</span> ₽</p>
            
            <!-- Fake QR Code -->
            <div class="relative inline-block bg-white p-4 rounded-2xl mb-6">
                <svg width="200" height="200" viewBox="0 0 200 200" class="block">
                    <!-- QR Pattern -->
                    <rect fill="#000" x="10" y="10" width="40" height="40"/>
                    <rect fill="#fff" x="15" y="15" width="30" height="30"/>
                    <rect fill="#000" x="20" y="            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            transform: rotate(45deg);
            transition: all 0.5s;
        }
        .btn-glow:hover::before {
            left: 100%;
        }
        .popup-overlay {
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        .popup-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        .popup-content {
            transform: scale(0.8);
            transition: all 0.3s ease;
        }
        .popup-overlay.active .popup-content {
            transform: scale(1);
        }
        @keyframes scanline {
            0% { top: 0; }
            100% { top: 100%; }
        }
        .qr-scanline {
            animation: scanline 2s linear infinite;
        }
    </style>
</head>
<body class="text-white p-4 md:p-8">
    <div class="max-w-6xl mx-auto">
        <!-- Header -->
        <header class="text-center mb-8">
            <h1 class="font-orbitron text-4xl md:text-6xl font-black bg-gradient-to-r from-green-400 via-yellow-400 to-green-400 bg-clip-text text-transparent">
                <i class="fas fa-gem text-green-400"></i> MineDep Casino
            </h1>
        </header>

        <!-- Balance Section -->
        <div class="glass rounded-2xl p-4 mb-6 flex flex-wrap justify-between items-center gap-4">
            <div class="flex items-center gap-3">
                <div class="w-12 h-12 bg-gradient-to-br from-yellow-400 to-yellow-600 rounded-full flex items-center justify-center text-2xl shadow-lg">
                    <i class="fas fa-coins text-yellow-900"></i>
                </div>
                <div>
                    <p class="text-gray-400 text-sm">Баланс</p>
                    <p class="font-orbitron text-2xl font-bold text-yellow-400" id="balance">1000.00</p>
                </div>
            </div>
            <button onclick="openDepositPopup()" class="bg-gradient-to-r from-purple-600 to-purple-800 hover:from-purple-500 hover:to-purple-700 px-6 py-2 rounded-xl font-bold transition-all btn-glow">
                <i class="fas fa-plus-circle mr-2"></i>Пополнить
            </button>
        </div>

        <div class="grid lg:grid-cols-3 gap-6">
            <!-- Game Controls -->
            <div class="glass rounded-2xl p-6 order-2 lg:order-1">
                <h2 class="font-orbitron text-xl mb-6 text-center"><i class="fas fa-cog mr-2"></i>Настройки</h2>
                
                <!-- Bet Amount -->
                <div class="mb-6">
                    <label class="text-gray-400 text-sm mb-2 block">Ставка</label>
                    <input type="text" inputmode="decimal" id="betAmount" value="10" 
                        oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1')"
                        class="w-full bg-gray-800/50 border border-gray-700 rounded-xl px-4 py-3 font-orbitron text-lg focus:border-green-500 focus:outline-none mb-2">
                    <div class="flex gap-2">
                        <button onclick="setBet(0.5)" class="flex-1 bg-gray-700 hover:bg-gray-600 px-3 py-2 rounded-lg text-sm transition-all">½</button>
                        <button onclick="setBet(2)" class="flex-1 bg-gray-700 hover:bg-gray-600 px-3 py-2 rounded-lg text-sm transition-all">2×</button>
                    </div>
                </div>

                <!-- Mines Count -->
                <div class="mb-6">
                    <label class="text-gray-400 text-sm mb-2 block">Количество мин: <span id="minesDisplay" class="text-red-400 font-bold">3</span></label>
                    <input type="range" id="minesCount" min="1" max="24" value="3" 
                        class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-red-500"
                        oninput="updateMinesDisplay()">
                    <div class="flex justify-between text-xs text-gray-500 mt-1">
                        <span>1</span>
                        <span>24</span>
                    </div>
                </div>

                <!-- Potential Win -->
                <div class="bg-gray-800/50 rounded-xl p-4 mb-6">
                    <div class="flex justify-between mb-2">
                        <span class="text-gray-400">Множитель</span>
                        <span class="font-orbitron text-green-400" id="currentMultiplier">1.00×</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-400">Потенциальный выигрыш</span>
                        <span class="font-orbitron text-yellow-400" id="potentialWin">0.00</span>
                    </div>
                </div>

                <!-- Action Buttons -->
                <button id="playBtn" onclick="startGame()" 
                    class="w-full bg-gradient-to-r from-green-500 to-green-700 hover:from-green-400 hover:to-green-600 py-4 rounded-xl font-orbitron font-bold text-lg mb-3 transition-all btn-glow pulse">
                    <i class="fas fa-play mr-2"></i>ИГРАТЬ
                </button>
                <button id="cashoutBtn" onclick="cashout()" disabled
                    class="w-full bg-gradient-to-r from-yellow-500 to-orange-500 hover:from-yellow-400 hover:to-orange-400 py-4 rounded-xl font-orbitron font-bold text-lg transition-all btn-glow disabled:opacity-50 disabled:cursor-not-allowed">
                    <i class="fas fa-hand-holding-dollar mr-2"></i>ЗАБРАТЬ
                </button>
            </div>

            <!-- Game Grid -->
            <div class="lg:col-span-2 order-1 lg:order-2">
                <div class="glass rounded-2xl p-6">
                    <div class="grid grid-cols-5 gap-3" id="gameGrid">
                        <!-- Tiles will be generated here -->
                    </div>
                </div>

                <!-- Game Info -->
                <div class="mt-4 flex flex-wrap justify-center gap-4 text-sm">
                    <div class="flex items-center gap-2 bg-gray-800/50 px-4 py-2 rounded-lg">
                        <i class="fas fa-gem text-2xl text-green-400"></i>
                        <span>Гемов найдено: <span id="gemsFound" class="text-green-400 font-bold">0</span></span>
                    </div>
                    <div class="flex items-center gap-2 bg-gray-800/50 px-4 py-2 rounded-lg">
                        <i class="fas fa-bomb text-2xl text-red-400"></i>
                        <span>Мин на поле: <span id="minesOnField" class="text-red-400 font-bold">3</span></span>
                    </div>
                </div>

                <!-- Sound Toggle -->
                <div class="mt-4 flex justify-center">
                    <button onclick="toggleSound()" id="soundBtn" class="bg-gray-800/50 hover:bg-gray-700/50 px-4 py-2 rounded-lg text-sm transition-all">
                        <i class="fas fa-volume-high mr-2" id="soundIcon"></i>
                        <span id="soundText">Звук: ВКЛ</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- History -->
        <div class="glass rounded-2xl p-6 mt-6">
            <h2 class="font-orbitron text-xl mb-4"><i class="fas fa-chart-line mr-2"></i>История игр</h2>
            <div id="history" class="flex gap-2 overflow-x-auto pb-2">
                <div class="text-gray-500 text-sm">История пуста</div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="text-center mt-8 text-gray-500 text-sm">
            <p class="mt-1">MineDep Casino © 2023-2026 | 18+</p>
        </footer>
    </div>

    <!-- Game Popup -->
    <div id="gamePopup" class="fixed inset-0 bg-black/80 flex items-center justify-center z-50 popup-overlay">
        <div class="glass rounded-3xl p-8 text-center max-w-md mx-4 popup-content">
            <div class="text-6xl mb-4" id="popupEmoji"><i class="fas fa-coins text-yellow-400"></i></div>
            <h2 class="font-orbitron text-3xl font-black mb-2" id="popupTitle">ВЫИГРЫШ!</h2>
            <p class="text-4xl font-orbitron text-yellow-400 mb-6" id="popupAmount">+100.00</p>
            <button onclick="closeGamePopup()" class="bg-gradient-to-r from-green-500 to-green-700 hover:from-green-400 hover:to-green-600 px-8 py-3 rounded-xl font-bold transition-all">
                <i class="fas fa-check mr-2"></i>Продолжить
            </button>
        </div>
    </div>

    <!-- Deposit Popup -->
    <div id="depositPopup" class="fixed inset-0 bg-black/80 flex items-center justify-center z-50 popup-overlay">
        <div class="glass rounded-3xl p-8 text-center max-w-md mx-4 popup-content">
            <div class="text-5xl mb-4"><i class="fas fa-wallet text-purple-400"></i></div>
            <h2 class="font-orbitron text-2xl font-black mb-6 text-purple-400">Пополнение баланса</h2>
            
            <div class="mb-6">
                <label class="text-gray-400 text-sm mb-2 block text-left">Сумма пополнения</label>
                <input type="text" inputmode="decimal" id="depositAmount" value="500" 
                    oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1')"
                    class="w-full bg-gray-800/50 border border-gray-700 rounded-xl px-4 py-3 font-orbitron text-xl text-center focus:border-purple-500 focus:outline-none">
            </div>
            
            <div class="flex gap-2 mb-6">
                <button onclick="setDepositAmount(100)" class="flex-1 bg-gray-700 hover:bg-gray-600 py-2 rounded-lg text-sm transition-all">100</button>
                <button onclick="setDepositAmount(500)" class="flex-1 bg-gray-700 hover:bg-gray-600 py-2 rounded-lg text-sm transition-all">500</button>
                <button onclick="setDepositAmount(1000)" class="flex-1 bg-gray-700 hover:bg-gray-600 py-2 rounded-lg text-sm transition-all">1000</button>
                <button onclick="setDepositAmount(5000)" class="flex-1 bg-gray-700 hover:bg-gray-600 py-2 rounded-lg text-sm transition-all">5000</button>
            </div>
            
            <button onclick="processPayment()" class="w-full bg-gradient-to-r from-purple-500 to-purple-700 hover:from-purple-400 hover:to-purple-600 py-4 rounded-xl font-orbitron font-bold text-lg mb-3 transition-all">
                <i class="fas fa-credit-card mr-2"></i>Оплатить
            </button>
            <button onclick="closeDepositPopup()" class="w-full bg-gray-700 hover:bg-gray-600 py-3 rounded-xl font-bold transition-all">
                <i class="fas fa-times mr-2"></i>Отмена
            </button>
        </div>
    </div>

    <!-- QR Code Popup -->
    <div id="qrPopup" class="fixed inset-0 bg-black/80 flex items-center justify-center z-50 popup-overlay">
        <div class="glass rounded-3xl p-8 text-center max-w-md mx-4 popup-content">
            <div class="text-5xl mb-4"><i class="fas fa-qrcode text-white"></i></div>
            <h2 class="font-orbitron text-xl font-black mb-2 text-white">Отсканируйте для оплаты</h2>
            <p class="text-gray-400 text-sm mb-6">Сумма: <span id="qrAmount" class="text-yellow-400 font-bold">500</span> ₽</p>
            
            <!-- Fake QR Code -->
            <div class="relative inline-block bg-white p-4 rounded-2xl mb-6">
                <svg width="200" height="200" viewBox="0 0 200 200" class="block">
                    <!-- QR Pattern -->
                    <rect fill="#000" x="10" y="10" width="40" height="40"/>
                    <rect fill="#fff" x="15" y="15" width="30" height="30"/>
                    <rect fill="#000" x="20" y="20" width="20" height="20"/>
                    
                    <rect fill="#000" x="150" y="10" width="40" height="40"/>
                    <rect fill="#fff" x="155" y="15" width="30" height="30"/>
                    <rect fill="#000" x="160" y="20" width="20" height="20"/>
                    
                    <rect fill="#000" x="10" y="150" width="40" height="40"/>
                    <rect fill="#fff" x="15" y="155" width="30" height="30"/>
                    <rect fill="#000" x="20" y="160" width="20" height="20"/>
                    
                    <!-- Random pattern -->
                    <rect fill="#000" x="60" y="10" width="10" height="10"/>
                    <rect fill="#000" x="80" y="10" width="10" height="10"/>
                    <rect fill="#000" x="100" y="10" width="10" height="10"/>
                    <rect fill="#000" x="120" y="10" width="10" height="10"/>
                    <rect fill="#000" x="60" y="30" width="10" height="10"/>
                    <rect fill="#000" x="90" y="30" width="10" height="10"/>
                    <rect fill="#000" x="110" y="30" width="10" height="10"/>
                    <rect fill="#000" x="130" y="30" width="10" height="10"/>
                    
                    <rect fill="#000" x="10" y="60" width="10" height="10"/>
                    <rect fill="#000" x="30" y="60" width="10" height="10"/>
                    <rect fill="#000" x="10" y="80" width="10" height="10"/>
                    <rect fill="#000" x="40" y="80" width="10" height="10"/>
                    <rect fill="#000" x="10" y="100" width="10" height="10"/>
                    <rect fill="#000" x="30" y="100" width="10" height="10"/>
                    <rect fill="#000" x="10" y="120" width="10" height="10"/>
                    <rect fill="#000" x="40" y="120" width="10" height="10"/>
                    
                    <rect fill="#000" x="60" y="60" width="10" height="10"/>
                    <rect fill="#000" x="80" y="60" width="10" height="10"/>
                    <rect fill="#000" x="100" y="60" width="10" height="10"/>
                    <rect fill="#000" x="120" y="60" width="10" height="10"/>
                    <rect fill="#000" x="70" y="70" width="10" height="10"/>
                    <rect fill="#000" x="90" y="70" width="10" height="10"/>
                    <rect fill="#000" x="110" y="70" width="10" height="10"/>
                    <rect fill="#000" x="130" y="70" width="10" height="10"/>
                    <rect fill="#000" x="60" y="80" width="10" height="10"/>
                    <rect fill="#000" x="80" y="80" width="10" height="10"/>
                    <rect fill="#000" x="100" y="80" width="10" height="10"/>
                    <rect fill="#000" x="120" y="80" width="10" height="10"/>
                    <rect fill="#000" x="70" y="90" width="10" height="10"/>
                    <rect fill="#000" x="90" y="90" width="10" height="10"/>
                    <rect fill="#000" x="110" y="90" width="10" height="10"/>
                    <rect fill="#000" x="60" y="100" width="10" height="10"/>
                    <rect fill="#000" x="80" y="100" width="10" height="10"/>
                    <rect fill="#000" x="100" y="100" width="10" height="10"/>
                    <rect fill="#000" x="120" y="100" width="10" height="10"/>
                    <rect fill="#000" x="140" y="100" width="10" height="10"/>
                    
                    <rect fill="#000" x="150" y="60" width="10" height="10"/>
                    <rect fill="#000" x="170" y="60" width="10" height="10"/>
                    <rect fill="#000" x="180" y="70" width="10" height="10"/>
                    <rect fill="#000" x="160" y="80" width="10" height="10"/>
                    <rect fill="#000" x="150" y="90" width="10" height="10"/>
                    <rect fill="#000" x="180" y="90" width="10" height="10"/>
                    <rect fill="#000" x="170" y="100" width="10" height="10"/>
                    <rect fill="#000" x="150" y="110" width="10" height="10"/>
                    <rect fill="#000" x="180" y="110" width="10" height="10"/>
                    <rect fill="#000" x="160" y="120" width="10" height="10"/>
                    <rect fill="#000" x="180" y="120" width="10" height="10"/>
                    
                    <rect fill="#000" x="60" y="120" width="10" height="10"/>
                    <rect fill="#000" x="80" y="120" width="10" height="10"/>
                    <rect fill="#000" x="100" y="120" width="10" height="10"/>
                    <rect fill="#000" x="120" y="120" width="10" height="10"/>
                    <rect fill="#000" x="70" y="130" width="10" height="10"/>
                    <rect fill="#000" x="90" y="130" width="10" height="10"/>
                    <rect fill="#000" x="110" y="130" width="10" height="10"/>
                    
                    <rect fill="#000" x="60" y="150" width="10" height="10"/>
                    <rect fill="#000" x="80" y="150" width="10" height="10"/>
                    <rect fill="#000" x="100" y="150" width="10" height="10"/>
                    <rect fill="#000" x="120" y="150" width="10" height="10"/>
                    <rect fill="#000" x="140" y="150" width="10" height="10"/>
                    <rect fill="#000" x="70" y="160" width="10" height="10"/>
                    <rect fill="#000" x="90" y="160" width="10" height="10"/>
                    <rect fill="#000" x="110" y="160" width="10" height="10"/>
                    <rect fill="#000" x="130" y="160" width="10" height="10"/>
                    <rect fill="#000" x="60" y="170" width="10" height="10"/>
                    <rect fill="#000" x="80" y="170" width="10" height="10"/>
                    <rect fill="#000" x="100" y="170" width="10" height="10"/>
                    <rect fill="#000" x="120" y="170" width="10" height="10"/>
                    <rect fill="#000" x="140" y="170" width="10" height="10"/>
                    <rect fill="#000" x="70" y="180" width="10" height="10"/>
                    <rect fill="#000" x="90" y="180" width="10" height="10"/>
                    <rect fill="#000" x="110" y="180" width="10" height="10"/>
                    <rect fill="#000" x="150" y="160" width="10" height="10"/>
                    <rect fill="#000" x="170" y="160" width="10" height="10"/>
                    <rect fill="#000" x="160" y="170" width="10" height="10"/>
                    <rect fill="#000" x="180" y="170" width="10" height="10"/>
                    <rect fill="#000" x="150" y="180" width="10" height="10"/>
                    <rect fill="#000" x="170" y="180" width="10" height="10"/>
                </svg>
                <!-- Scanline animation -->
                <div class="absolute left-0 right-0 h-1 bg-green-500/50 qr-scanline" style="box-shadow: 0 0 10px #00ff88;"></div>
            </div>
            
            <div class="flex items-center justify-center gap-2 text-gray-400">
                <i class="fas fa-spinner fa-spin"></i>
                <span>Ожидание оплаты... <span id="qrTimer">5</span>с</span>
            </div>
        </div>
    </div>

    <script>
        // Audio Context for sounds
        let audioContext = null;
        let soundEnabled = true;

        function initAudio() {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
        }

        function playSound(type) {
            if (!soundEnabled) return;
            initAudio();
            
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            switch(type) {
                case 'click':
                    oscillator.frequency.setValueAtTime(600, audioContext.currentTime);
                    oscillator.frequency.exponentialRampToValueAtTime(400, audioContext.currentTime + 0.1);
                    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.1);
                    break;
                case 'gem':
                    oscillator.type = 'sine';
                    oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
                    oscillator.frequency.exponentialRampToValueAtTime(1200, audioContext.currentTime + 0.15);
                    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.2);
                    break;
                case 'mine':
                    oscillator.type = 'sawtooth';
                    oscillator.frequency.setValueAtTime(200, audioContext.currentTime);
                    oscillator.frequency.exponentialRampToValueAtTime(50, audioContext.currentTime + 0.5);
                    gainNode.gain.setValueAtTime(0.4, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.5);
                    break;
                case 'win':
                    [0, 0.1, 0.2, 0.3].forEach((delay, i) => {
                        const osc = audioContext.createOscillator();
                        const gain = audioContext.createGain();
                        osc.connect(gain);
                        gain.connect(audioContext.destination);
                        osc.type = 'sine';
                        osc.frequency.setValueAtTime([523, 659, 784, 1047][i], audioContext.currentTime + delay);
                        gain.gain.setValueAtTime(0.2, audioContext.currentTime + delay);
                        gain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + delay + 0.2);
                        osc.start(audioContext.currentTime + delay);
                        osc.stop(audioContext.currentTime + delay + 0.2);
                    });
                    break;
                case 'start':
                    oscillator.type = 'square';
                    oscillator.frequency.setValueAtTime(300, audioContext.currentTime);
                    oscillator.frequency.exponentialRampToValueAtTime(600, audioContext.currentTime + 0.15);
                    gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.15);
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.15);
                    break;
            }
        }

        function toggleSound() {
            soundEnabled = !soundEnabled;
            document.getElementById('soundIcon').className = soundEnabled ? 'fas fa-volume-high mr-2' : 'fas fa-volume-xmark mr-2';
            document.getElementById('soundText').textContent = soundEnabled ? 'Звук: ВКЛ' : 'Звук: ВЫКЛ';
            if (soundEnabled) playSound('click');
        }

        // Game State
        let balance = 1000;
        let currentBet = 10;
        let minesCount = 3;
        let gameActive = false;
        let gemsFound = 0;
        let currentMultiplier = 1;
        let grid = [];
        let revealedTiles = [];
        let history = [];

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            createGrid();
            updateDisplay();
        });

        function createGrid() {
            const gridEl = document.getElementById('gameGrid');
            gridEl.innerHTML = '';
            
            for (let i = 0; i < 25; i++) {
                const tile = document.createElement('div');
                tile.className = 'tile aspect-square rounded-xl cursor-pointer relative';
                tile.innerHTML = `
                    <div class="tile-inner w-full h-full">
                        <div class="tile-front bg-gradient-to-br from-indigo-600/30 to-purple-600/30 flex items-center justify-center text-3xl">
                            <i class="fas fa-question text-gray-500"></i>
                        </div>
                        <div class="tile-back" id="tile-back-${i}"></div>
                    </div>
                `;
                tile.onclick = () => revealTile(i);
                gridEl.appendChild(tile);
            }
        }

        function startGame() {
            const betInput = document.getElementById('betAmount');
            currentBet = parseFloat(betInput.value) || 0;
            minesCount = parseInt(document.getElementById('minesCount').value);

            if (currentBet > balance) {
                showGamePopup('error', 'Недостаточно средств!', '');
                return;
            }

            if (currentBet < 1) {
                showGamePopup('error', 'Минимальная ставка: 1', '');
                return;
            }

            playSound('start');

            // Deduct bet
            balance -= currentBet;
            updateBalance();

            // Reset game state
            gameActive = true;
            gemsFound = 0;
            currentMultiplier = 1;
            revealedTiles = [];

            // Generate mines
            grid = Array(25).fill('gem');
            let minesPlaced = 0;
            while (minesPlaced < minesCount) {
                const pos = Math.floor(Math.random() * 25);
                if (grid[pos] !== 'mine') {
                    grid[pos] = 'mine';
                    minesPlaced++;
                }
            }

            // Reset tiles
            createGrid();
            updateDisplay();

            // Update buttons
            document.getElementById('playBtn').disabled = true;
            document.getElementById('playBtn').classList.remove('pulse');
            document.getElementById('cashoutBtn').disabled = true;
            document.getElementById('minesOnField').textContent = minesCount;
        }

        function revealTile(index) {
            if (!gameActive || revealedTiles.includes(index)) return;

            const tiles = document.querySelectorAll('.tile');
            const tile = tiles[index];
            const tileBack = document.getElementById(`tile-back-${index}`);
            
            revealedTiles.push(index);

            if (grid[index] === 'mine') {
                // Hit a mine!
                playSound('mine');
                tileBack.className = 'tile-back mine flex items-center justify-center text-4xl';
                tileBack.innerHTML = '<i class="fas fa-bomb"></i>';
                tile.classList.add('revealed');
                
                setTimeout(() => {
                    tile.classList.add('shake');
                    gameOver(false);
                }, 300);
            } else {
                // Found a gem!
                playSound('gem');
                tileBack.className = 'tile-back gem flex items-center justify-center text-4xl';
                tileBack.innerHTML = '<i class="fas fa-gem"></i>';
                tile.classList.add('revealed');
                
                gemsFound++;
                calculateMultiplier();
                document.getElementById('cashoutBtn').disabled = false;
                
                // Check if all gems found
                if (gemsFound === 25 - minesCount) {
                    setTimeout(() => cashout(), 500);
                }
            }

            updateDisplay();
        }

        function calculateMultiplier() {
            const safeSpots = 25 - minesCount;
            let multiplier = 1;
            for (let i = 0; i < gemsFound; i++) {
                multiplier *= (25 - i) / (25 - minesCount - i);
            }
            currentMultiplier = multiplier * 0.97;
            currentMultiplier = Math.max(1, currentMultiplier);
        }

        function cashout() {
            if (!gameActive || gemsFound === 0) return;

            playSound('win');

            const winAmount = currentBet * currentMultiplier;
            balance += winAmount;
            updateBalance();

            addToHistory(true, winAmount);
            revealAllTiles();

            showGamePopup('win', 'ВЫИГРЫШ!', `+${winAmount.toFixed(2)}`);
            
            gameActive = false;
            resetButtons();
        }

        function gameOver(won) {
            gameActive = false;
            revealAllTiles();
            
            if (!won) {
                addToHistory(false, currentBet);
                showGamePopup('lose', 'БАБАХ!', `-${currentBet.toFixed(2)}`);
            }
            
            resetButtons();
        }

        function revealAllTiles() {
            const tiles = document.querySelectorAll('.tile');
            grid.forEach((type, index) => {
                if (!revealedTiles.includes(index)) {
                    const tileBack = document.getElementById(`tile-back-${index}`);
                    if (type === 'mine') {
                        tileBack.className = 'tile-back mine flex items-center justify-center text-4xl opacity-50';
                        tileBack.innerHTML = '<i class="fas fa-bomb"></i>';
                    } else {
                        tileBack.className = 'tile-back gem flex items-center justify-center text-4xl opacity-50';
                        tileBack.innerHTML = '<i class="fas fa-gem"></i>';
                    }
                    setTimeout(() => {
                        tiles[index].classList.add('revealed');
                    }, index * 30);
                }
            });
        }

        function resetButtons() {
            document.getElementById('playBtn').disabled = false;
            document.getElementById('playBtn').classList.add('pulse');
            document.getElementById('cashoutBtn').disabled = true;
        }

        function updateDisplay() {
            document.getElementById('gemsFound').textContent = gemsFound;
            document.getElementById('currentMultiplier').textContent = currentMultiplier.toFixed(2) + '×';
            const bet = parseFloat(document.getElementById('betAmount').value) || 0;
            document.getElementById('potentialWin').textContent = (bet * currentMultiplier).toFixed(2);
        }

        function updateBalance() {
            document.getElementById('balance').textContent = balance.toFixed(2);
            document.getElementById('balance').classList.add('coin-drop');
            setTimeout(() => {
                document.getElementById('balance').classList.remove('coin-drop');
            }, 500);
        }

        function updateMinesDisplay() {
            const mines = document.getElementById('minesCount').value;
            document.getElementById('minesDisplay').textContent = mines;
            document.getElementById('minesOnField').textContent = mines;
        }

        function setBet(multiplier) {
            playSound('click');
            const betInput = document.getElementById('betAmount');
            let currentVal = parseFloat(betInput.value) || 0;
            let newBet = currentVal * multiplier;
            newBet = Math.max(1, Math.min(balance, newBet));
            betInput.value = Math.floor(newBet);
        }

        function addToHistory(won, amount) {
            history.unshift({ won, amount });
            if (history.length > 10) history.pop();
            
            const historyEl = document.getElementById('history');
            historyEl.innerHTML = history.map(h => `
                <div class="flex-shrink-0 px-4 py-2 rounded-lg ${h.won ? 'bg-green-500/20 text-green-400' : 'bg-red-500/20 text-red-400'}">
                    <i class="fas ${h.won ? 'fa-check-circle' : 'fa-times-circle'} mr-1"></i>
                    ${h.won ? '+' : '-'}${h.amount.toFixed(2)}
                </div>
            `).join('');
        }

        // Game Popup Functions
        function showGamePopup(type, title, amount) {
            const popup = document.getElementById('gamePopup');
            const emoji = document.getElementById('popupEmoji');
            const titleEl = document.getElementById('popupTitle');
            const amountEl = document.getElementById('popupAmount');

            if (type === 'win') {
                emoji.innerHTML = '<i class="fas fa-trophy text-yellow-400"></i>';
                titleEl.className = 'font-orbitron text-3xl font-black mb-2 text-green-400';
            } else if (type === 'lose') {
                emoji.innerHTML = '<i class="fas fa-skull-crossbones text-red-400"></i>';
                titleEl.className = 'font-orbitron text-3xl font-black mb-2 text-red-400';
            } else {
                emoji.innerHTML = '<i class="fas fa-exclamation-triangle text-yellow-400"></i>';
                titleEl.className = 'font-orbitron text-3xl font-black mb-2 text-yellow-400';
            }

            titleEl.textContent = title;
            amountEl.textContent = amount;
            amountEl.className = `text-4xl font-orbitron mb-6 ${type === 'lose' ? 'text-red-400' : 'text-yellow-400'}`;
            
            popup.classList.add('active');
        }

        function closeGamePopup() {
            playSound('click');
            document.getElementById('gamePopup').classList.remove('active');
        }

        // Deposit Popup Functions
        function openDepositPopup() {
            playSound('click');
            document.getElementById('depositPopup').classList.add('active');
        }

        function closeDepositPopup() {
            playSound('click');
            document.getElementById('depositPopup').classList.remove('active');
        }

        function setDepositAmount(amount) {
            playSound('click');
            document.getElementById('depositAmount').value = amount;
        }

        function processPayment() {
            playSound('click');
            const amount = parseFloat(document.getElementById('depositAmount').value) || 0;
            document.getElementById('qrAmount').textContent = amount;
            
            closeDepositPopup();
            
            setTimeout(() => {
                document.getElementById('qrPopup').classList.add('active');
                
                let timer = 5;
                const timerEl = document.getElementById('qrTimer');
                const interval = setInterval(() => {
                    timer--;
                    timerEl.textContent = timer;
                    if (timer <= 0) {
                        clearInterval(interval);
                        document.getElementById('qrPopup').classList.remove('active');
                        timerEl.textContent = '5';
                        
                        // Пополняем баланс
                        balance += amount;
                        updateBalance();
                        playSound('win');
                        
                        // Показываем уведомление об успешном пополнении
                        setTimeout(() => {
                            showGamePopup('win', 'ПОПОЛНЕНО!', `+${amount.toFixed(2)}`);
                        }, 300);
                    }
                }, 1000);
            }, 300);
        }

        // Keyboard support
        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space' && !gameActive) {
                e.preventDefault();
                startGame();
            }
            if (e.code === 'Enter' && gameActive && gemsFound > 0) {
                e.preventDefault();
                cashout();
            }
            if (e.code === 'Escape') {
                closeGamePopup();
                closeDepositPopup();
                document.getElementById('qrPopup').classList.remove('active');
            }
        });

        // Close popups on overlay click
        document.getElementById('gamePopup').addEventListener('click', (e) => {
            if (e.target.id === 'gamePopup') closeGamePopup();
        });
        document.getElementById('depositPopup').addEventListener('click', (e) => {
            if (e.target.id === 'depositPopup') closeDepositPopup();
        });
    </script>
</body>
</html>
